# Search Engine
##Курсовой проект Skillbox
___

###При работе над проектом преследовались следующие цели: 

- практическая отработка и закрепление пройденных на курсе материалов
- отработка навыков прямого взаимодействия с БД

___

### Принципы проекта, заложенные на этапе постановки задачи:
1. В конфигурационном файле перед запуском приложения задаются
   адреса сайтов, по которым движок должен будет осуществлять поиск.
2. Поисковый движок должен самостоятельно обходить все страницы
   заданных сайтов и индексировать их таким образом, чтобы потом по
   любому поисковому запросу находить наиболее релевантные
   (подходящие) страницы.
3. Пользователь присылает запрос через API движка. Запрос — это набор
   слов, по которым нужно найти страницы сайта.
4. Запрос определённым образом трансформируется в список слов,
   переведённых в базовую форму (например, для существительных —
   именительный падеж, единственное число).
5. В индексе ищутся те страницы, на которых встречаются все эти слова.
6. Результаты поиска ранжируются, сортируются и отдаются пользователю.

### Дополнительные принципы, используемые при работе над проектом и ограничения, связанные с ними:
1. Таблицы в БД должны точно соответствовать заданной постановке
2. Логика работы программы должна максимально соответствовать заданным постановкам
3. Информация получаемая со страниц сайтов и используемая для формирования результатов не должна храниться в объектах java, а должна сохраняться и считываться из БД.

**Возникшие ограничения:** В рамках требования по возможности преиндексации отдельных страниц сайте не учитывается возможное изменение лемм на переиндексируемой странице. Ограничение вызвано тем, что в БД не содержится сведений о кол-ве лемм для отдельной страницы. При этом возможна переиндексация сайта с полным пересчётом лемм для данного сайта.
___
## Описание настроек приложения
- sites - перечень сайтов для индексации
- connectionTimeout - время ожидания в (мс.) перед попыткой соединения со страницей сайта
- maxConnectionAttempt - максимальное кол-во попыток подключения к странице сайта в случае возникновения ошибок соединения со страницей
- criticalDelayInIterationsToLog - кол-во попыток соединения со страницей, после которых страница будет внесена в лог работы приложения с соответствующим сообщением
- pageQueueInsertSize - пороговое значение кол-ва страниц, которые могут быть отправлены в БД в рамках одной посылки. Для справки: Изначально значение носило иной смысл - минимальное кол-во станиц в очереди, по достижению которого начинался процесс отправки пакета страниц в БД. Недостатки алгоритма работы привели к его изменению и изменению значения параметра.
- pageQuantityCoefficientToOptimizeLemmas - коэффициент, который реализует требование задачи Этапа 5: в результатах поиска исключить леммы, встречающиеся на слишком большом кол-ве страниц. Определят долю страниц из общего кол-ва, для данного сайта, при вхождении леммы в которую происходит её исключение из результатов поиска
- minPageQuantityToOptimizeLemmas - минимальное кол-во страниц в БД, при достижении которого начинают отсеиваться часто-встречающиеся леммы
- wordsInSnippet - кол-во слов, выделяемое в рамках одного "предложения" в снипете
- stringPartsInSnippet - кол-во "предложений" в снипете
- titleWeight - условия задачи
- bodyWeight - условия задачи
- wordInfoToExcept - исключаемые из морфологического разбора части речи
- notIndexedPagesCodes - коды ответов, при которых страницы не участвуют в морфологическом разборе
- userAgent - наименование агента, от имени которого происходит соединение с сайтом
- referrer - указание источника ссылки на страницу при соединении
- domainNotFilesList - наименования доменов, страницы с которых попадают в обработку. Остальные наименования воспринимаются как расширения файлов и исключаются из обработки
- onlyQueryMode - значение "true" включает демонстрационные режим приложения, при котором не происходит индексация сайтов и изменения в БД. В данном режиме происходит только генерация результатов запросов 

##Техническое описание проекта и проектных решений

1. В качестве механизма для доступа к БД был выбран JDBC API. Выбор механизма обусловлен желанием изучить наиболее прямой и прозрачный способ доступа к данным БД с целью отработки навыков и изучением особенностей работы механизма
2. При полной индексации перечня сайтов задачи запускаются функцией invoke() общего пула потоков для каждого сайта в цикле. Что приводит к последовательной обработке сайтов в многопоточном режиме
3. При этом существует возможность запустить индексацию каждого сайта по отдельности с помощью интерфейса пользователя. В этом случае задачи на индексацию инициируются функцией execute() и выполняются параллельно для каждого указанного сайта
4. П.2 и п.3 в сумме позволили отработать различные режимы запуска многопоточных задач с целью обучения
5. Кнопка "Stop indexing", при последовательном запуске сайтов на индексацию, отображается при отдельном запуске полного перечня сайтов
6. Использование механизма batchUpdate() для страниц сайтов вызвано интересом обучения и является спорным с т.ч. рациональности
7. Использование коллекции queryQueryResultMap в классе QueryController вызвано желанием кешировать результаты запроса при обработке параметров запроса (offset и limit). Условия выбора результата из данной коллекции (не более 30 секунд с момента запроса - TIME_THRESHOLD) носят условный характер для данной задачи
8. Статус "INDEXED" для сайта выставляется при индексации всех доступных страниц сайта. При наличии страниц с ошибками, их url логируется с соответствующим сообщением, а в интерфейсе отображается соответствующая ошибка


